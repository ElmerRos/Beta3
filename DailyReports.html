 <!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Reporte Diario y Semanal</title>
  <!-- Bootstrap CSS -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
  <!-- Bootstrap Icons -->
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css"
  />
  <!-- Google Fonts -->
  <link
    href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Poppins:wght@400;700&display=swap"
    rel="stylesheet"
  />
  <!-- html2canvas (para exportar PDF/imagen) -->
  <script
    src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"
    defer
  ></script>

  <!-- 
    ===================================
    CSS principal
    Basado en tu styles.css (neón), 
    ajustado con extras para tabs, 
    modals de salidas, etc.
    ===================================
  -->
  <style>
    /* ===========================
       1) BASE COLORS & FONTS
       =========================== */
    :root {
      --color-fondo: #0a0a0a; /* Dark background */
      --color-neon-cian: #00ffff;
      --color-neon-morado: #ff00ff;
      --color-neon-verde: #39ff14;
      --color-texto: #ffffff;
      --color-placeholder: #cccccc;
      --color-fondo-acordeon: #1e1e1e;
      --color-fondo-acordeon-activo: #00ffff;
      --color-texto-acordeon: #ffffff;
      --color-error: #ff00ff;

      /* Colores alternos para Light Mode */
      --light-bg: #f3f3e7; 
      --light-text: #000;
      --light-border: #ccc;
      --light-highlight: #007bff;
    }

    /* Modo claro: activado al añadir la clase .light-mode al body */
    body.light-mode {
      background-color: var(--light-bg) !important;
      color: var(--light-text) !important;
    }
    body.light-mode .container {
      background: #ffffff !important;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1) !important;
    }
    body.light-mode h2 {
      color: var(--light-highlight) !important;
      text-shadow: none !important;
    }
    body.light-mode .table-dark {
      background-color: #fafafa !important;
      color: #000 !important;
    }
    body.light-mode .table-dark th {
      background-color: #eee !important;
      color: #000 !important;
      text-shadow: none !important;
    }
    body.light-mode .table-dark td {
      color: #000 !important;
    }
    body.light-mode .modal-content {
      background-color: #ffffff !important;
      color: #000 !important;
      box-shadow: 0 0 10px #ccc !important;
      border: 2px solid #ccc !important;
    }
    body.light-mode .modal-header,
    body.light-mode .modal-footer {
      border-color: #ccc !important;
    }
    body.light-mode .nav-link.active {
      background-color: var(--light-highlight) !important;
      color: #fff !important;
    }
    body.light-mode .btn-primary {
      background-color: var(--light-highlight) !important;
      box-shadow: none !important;
      color: #fff !important;
    }
    body.light-mode .btn-success {
      background-color: #28a745 !important;
      color: #fff !important;
      box-shadow: none !important;
    }

    /* Fondo general + tipografía */
    body {
      background-color: var(--color-fondo);
      color: var(--color-texto);
      font-family: 'Montserrat', 'Poppins', sans-serif;
      margin: 0;
      padding: 0;
      overflow-x: hidden;
    }
    /* Contenedor principal */
    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 20px;
      background: rgba(10, 10, 10, 0.95);
      border-radius: 15px;
      box-shadow: 0 0 30px rgba(0, 255, 255, 0.2);
      margin-top: 60px; /* espaciado superior */
      min-height: 80vh;
    }

    /* Título principal */
    h2 {
      text-align: center;
      margin-bottom: 20px;
      color: var(--color-neon-cian);
      text-shadow: 0 0 10px var(--color-neon-cian);
      font-size: 2rem; 
    }

    /* ===========================
       2) NAV TABS LATERALES
       =========================== */
    .nav-pills {
      flex-direction: column;
      width: 200px;
      margin-right: 20px;
    }
    .nav-pills .nav-link {
      color: var(--color-texto);
      border: 1px solid transparent;
      margin-bottom: 5px;
      font-size: 1.2rem;
      text-align: center;
      transition: background-color 0.3s, color 0.3s;
      border-radius: 5px;
    }
    .nav-pills .nav-link:hover {
      background-color: #2a2a2a;
    }
    .nav-pills .nav-link.active {
      background-color: var(--color-neon-cian);
      color: #000;
    }

    /* Contenedor principal de tabs */
    .tab-content {
      flex: 1;
    }
    .d-flex.tab-container {
      display: flex;
    }

    /* ===========================
       3) TABLA DIARIA
       =========================== */
    .pages-table th {
      background-color: #1e1e1e;
      color: var(--color-neon-cian);
      text-shadow: 0 0 5px var(--color-neon-cian);
      font-size: 1.2rem;
    }
    .pages-table td {
      font-size: 1.3rem;
      vertical-align: middle;
    }
    .table-row-btn {
      min-width: 40px;
      color: #fff;
      background-color: #ff0044;
      border: none;
      padding: 4px 8px;
      border-radius: 6px;
      box-shadow: 0 0 5px #ff0044;
      transition: transform 0.2s;
    }
    .table-row-btn:hover {
      background-color: #cc0033;
      transform: scale(1.05);
    }
    .pages-table input[type="number"] {
      width: 120px;
      text-align: right;
    }
    .pages-table input::placeholder {
      color: var(--color-placeholder);
    }

    /* SALIDAS con color si hay pendientes/pagados */
    .salidas-cell.pendiente {
      color: var(--color-neon-morado);
      font-weight: bold;
      cursor: pointer;
    }
    .salidas-cell.pagado {
      color: #ff0044;
      font-weight: bold;
      cursor: pointer;
    }

    /* ===========================
       4) BOTONES GLOBALES
       =========================== */
    .btn {
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 1.2rem;
    }
    .btn-primary {
      background-color: var(--color-neon-cian);
      color: #000;
      box-shadow: 0 0 10px var(--color-neon-cian);
    }
    .btn-primary:hover {
      background-color: #00cccc;
      box-shadow: 0 0 20px var(--color-neon-cian);
      transform: scale(1.05);
    }
    .btn-danger {
      background-color: #ff0044;
      color: #fff;
      box-shadow: 0 0 10px #ff0044;
      min-width: 150px;
    }
    .btn-danger:hover {
      background-color: #cc0033;
      box-shadow: 0 0 20px #ff0044;
      transform: scale(1.05);
    }
    .btn-warning {
      color: #000;
      background-color: #ffcb00;
      box-shadow: 0 0 10px #ffcb00;
    }
    .btn-warning:hover {
      background-color: #e0b300;
      box-shadow: 0 0 20px #ffcb00;
      transform: scale(1.05);
    }
    .btn-success {
      background-color: var(--color-neon-verde);
      color: #000;
      box-shadow: 0 0 10px var(--color-neon-verde), 0 0 20px var(--color-neon-verde);
      animation: pulse 2s infinite;
    }
    .btn-success:hover {
      transform: scale(1.02);
    }
    @keyframes pulse {
      0% {
        box-shadow: 0 0 10px var(--color-neon-verde), 0 0 20px var(--color-neon-verde);
      }
      50% {
        box-shadow: 0 0 20px var(--color-neon-verde), 0 0 30px var(--color-neon-verde);
      }
      100% {
        box-shadow: 0 0 10px var(--color-neon-verde), 0 0 20px var(--color-neon-verde);
      }
    }

    /* ===========================
       5) CUADRE DIARIO
       =========================== */
    .cuadre-container {
      margin-top: 20px;
      border: 1px solid var(--color-neon-cian);
      padding: 15px;
      border-radius: 10px;
    }
    .cuadre-container h4 {
      color: var(--color-neon-cian);
      text-shadow: 0 0 5px var(--color-neon-cian);
      margin-bottom: 15px;
      font-size: 1.5rem;
    }
    .cuadre-row {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      margin-bottom: 10px;
    }
    .cuadre-row label {
      min-width: 120px;
      font-weight: bold;
      margin-right: 10px;
    }
    .cuadre-row input[type="number"] {
      width: 150px;
      text-align: right;
    }
    .total-subtotal {
      color: var(--color-neon-morado);
      font-weight: bold;
    }
    .net-balance.positivo {
      color: #00f; /* azul */
      font-weight: bold;
    }
    .net-balance.negativo {
      color: #ff0044; /* rojo */
      font-weight: bold;
    }
    .net-balance.cero {
      color: #000; /* negro */
      font-weight: bold;
    }

    /* Opcional: Botoncito rojo para eliminar campos de Cash, Sucursal, etc. */
    .optional-field {
      display: flex;
      align-items: center;
      margin-bottom: 5px;
    }
    .optional-field input[type="number"] {
      margin-right: 8px;
    }
    .delete-optional-btn {
      background-color: #ff0044;
      color: #fff;
      border: none;
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 0.9rem;
      cursor: pointer;
    }

    /* ===========================
       6) MODAL DE SALIDAS
       =========================== */
    .modal-content {
      background-color: #0a0a0a;
      color: #ffffff;
      box-shadow: 0 0 20px var(--color-neon-cian);
      border: 2px solid var(--color-neon-cian);
    }
    .modal-header,
    .modal-footer {
      border-bottom: 1px solid var(--color-neon-cian);
      border-top: 1px solid var(--color-neon-cian);
    }
    .modal-title {
      color: var(--color-neon-cian);
    }
    .salida-pendiente {
      color: var(--color-neon-morado);
      font-weight: bold;
    }
    .salida-pagada {
      color: #ff0044;
      font-weight: bold;
    }

    /* ===========================
       7) TAB RESUMEN SEMANAL
       =========================== */
    .weekly-container h3 {
      color: var(--color-neon-cian);
      text-shadow: 0 0 5px var(--color-neon-cian);
      margin-bottom: 20px;
      font-size: 1.6rem;
      text-align: center;
    }
    .weekly-row label {
      min-width: 180px;
      font-weight: bold;
      margin-right: 10px;
    }
    .weekly-row input[type="number"] {
      width: 180px;
      text-align: right;
      margin-bottom: 10px;
    }
    .weekly-row {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
    }
    .weekly-row span {
      margin-left: 10px;
    }

    /* ===========================
       8) LOCK ICONS
       =========================== */
    .lock-icon {
      font-size: 1.5rem;
      margin-left: 10px;
      cursor: pointer;
      transition: color 0.3s;
    }
    .locked {
      color: #ff0044; /* rojo */
    }
    .unlocked {
      color: var(--color-neon-verde);
    }

    /* ===========================
       9) MANUAL
       =========================== */
    .manual-section {
      padding: 20px;
    }

    /* ===========================
       10) PIN OVERLAY
       =========================== */
    #pinOverlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.9);
      color: #fff;
      z-index: 999999;
      display: none;
      justify-content: center;
      align-items: center;
      text-align: center;
      flex-direction: column;
    }
    #pinOverlay input {
      font-size: 2rem;
      text-align: center;
      width: 200px;
      margin-bottom: 10px;
    }
    #pinOverlay button {
      font-size: 1.5rem;
    }

    /* ===========================
       RESPONSIVE
       =========================== */
    @media (max-width: 992px) {
      .nav-pills {
        flex-direction: row;
        margin-bottom: 20px;
        width: 100%;
      }
      .nav-pills .nav-link {
        flex: 1;
        margin-bottom: 0px;
      }
      .tab-container {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <!-- Overlay para PIN -->
  <div id="pinOverlay">
    <h3>Ingrese PIN de Acceso</h3>
    <input type="password" id="pinInput" maxlength="4" />
    <br />
    <button class="btn btn-primary" id="pinSubmit">Acceder</button>
    <button class="btn btn-danger" id="pinCancel">Cancelar</button>
  </div>

  <!-- Botón oculto para abrir PIN (ejemplo). Colócalo en un rinconcito. -->
  <button
    id="accessReportBtn"
    style="
      position: fixed;
      bottom: 10px;
      right: 10px;
      background: transparent;
      border: none;
      color: #fff;
      cursor: pointer;
      font-size: 1.2rem;
      z-index: 9999;
    "
  >
    <i class="bi bi-lock-fill"></i>
  </button>

  <!-- Toggle Dark/Light -->
  <button
    id="toggleModeBtn"
    class="btn btn-secondary"
    style="
      position: fixed;
      top: 10px;
      left: 10px;
      z-index: 9999;
    "
  >
    Modo Light
  </button>

  <div class="container d-none" id="mainReportContainer">
    <h2>Reporte Diario y Semanal</h2>

    <!-- NAV TABS LATERALES -->
    <div class="d-flex tab-container">
      <ul
        class="nav nav-pills me-3"
        id="pills-tab"
        role="tablist"
        style="flex-shrink: 0;"
      >
        <li class="nav-item" role="presentation">
          <button
            class="nav-link active"
            id="pills-lunes-tab"
            data-bs-toggle="pill"
            data-bs-target="#pills-lunes"
            type="button"
            role="tab"
            aria-controls="pills-lunes"
            aria-selected="true"
          >
            Lunes
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="pills-martes-tab"
            data-bs-toggle="pill"
            data-bs-target="#pills-martes"
            type="button"
            role="tab"
            aria-controls="pills-martes"
            aria-selected="false"
          >
            Martes
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="pills-miercoles-tab"
            data-bs-toggle="pill"
            data-bs-target="#pills-miercoles"
            type="button"
            role="tab"
            aria-controls="pills-miercoles"
            aria-selected="false"
          >
            Miércoles
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="pills-jueves-tab"
            data-bs-toggle="pill"
            data-bs-target="#pills-jueves"
            type="button"
            role="tab"
            aria-controls="pills-jueves"
            aria-selected="false"
          >
            Jueves
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="pills-viernes-tab"
            data-bs-toggle="pill"
            data-bs-target="#pills-viernes"
            type="button"
            role="tab"
            aria-controls="pills-viernes"
            aria-selected="false"
          >
            Viernes
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="pills-sabado-tab"
            data-bs-toggle="pill"
            data-bs-target="#pills-sabado"
            type="button"
            role="tab"
            aria-controls="pills-sabado"
            aria-selected="false"
          >
            Sábado
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="pills-domingo-tab"
            data-bs-toggle="pill"
            data-bs-target="#pills-domingo"
            type="button"
            role="tab"
            aria-controls="pills-domingo"
            aria-selected="false"
          >
            Domingo
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="pills-semanal-tab"
            data-bs-toggle="pill"
            data-bs-target="#pills-semanal"
            type="button"
            role="tab"
            aria-controls="pills-semanal"
            aria-selected="false"
          >
            Resumen
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="pills-manual-tab"
            data-bs-toggle="pill"
            data-bs-target="#pills-manual"
            type="button"
            role="tab"
            aria-controls="pills-manual"
            aria-selected="false"
          >
            Manual
          </button>
        </li>
      </ul>

      <div class="tab-content" id="pills-tabContent" style="width:100%;">
        <!-- =========================================
             1) Pestañas Lunes a Domingo (7 tabs)
             ========================================= -->
        <div
          class="tab-pane fade show active"
          id="pills-lunes"
          role="tabpanel"
          aria-labelledby="pills-lunes-tab"
        >
          <div class="day-tab" data-day-index="1">
            <!-- Contenido día Lunes -->
            <div class="mb-3">
              <label>Nombre de la Tienda:</label>
              <input type="text" class="form-control" id="tienda-1" placeholder="Mi Tienda" />
            </div>
            <div class="mb-3 d-flex gap-3">
              <div>
                <label>Fecha (DD/MM/AAAA):</label>
                <input
                  type="text"
                  class="form-control"
                  id="fecha-1"
                  placeholder="dd/mm/2025"
                />
              </div>
              <div>
                <label>Día de la Semana:</label>
                <input
                  type="text"
                  class="form-control"
                  id="diaSemana-1"
                  value="Lunes"
                  readonly
                />
              </div>
              <!-- Candado individual -->
              <div class="d-flex align-items-end">
                <i
                  class="bi bi-unlock lock-icon unlocked"
                  id="lockDay-1"
                  data-day="1"
                  title="Bloquear/Desbloquear Día"
                ></i>
              </div>
            </div>

            <!-- Tabla de “páginas” -->
            <div class="table-responsive">
              <table class="table table-dark table-bordered pages-table" id="dayTable-1">
                <thead>
                  <tr>
                    <th># Página</th>
                    <th>Centenas</th>
                    <th>Pulitos</th>
                    <th class="text-center">Salidas</th>
                    <th>Total</th>
                    <th>Acción</th>
                  </tr>
                </thead>
                <tbody>
                  <!-- Se generan 20 filas por defecto vía JS -->
                </tbody>
              </table>
            </div>
            <button
              class="btn btn-primary mb-3"
              id="addPageBtn-1"
            >
              Añadir Página
            </button>

            <!-- Totales y Overlook -->
            <div class="row mb-3">
              <div class="col-md-3">
                <strong>Total Centenas:</strong>
                <span id="totalCentenas-1">0.00</span>
              </div>
              <div class="col-md-3">
                <strong>Total Pulitos:</strong>
                <span id="totalPulitos-1">0.00</span>
              </div>
              <div class="col-md-3">
                Overlook:
                <input
                  type="number"
                  id="overlook-1"
                  step="1"
                  placeholder="0"
                  class="form-control"
                  style="width:120px; display:inline-block;"
                />
              </div>
              <div class="col-md-3">
                <strong>Total Salidas:</strong>
                <span id="totalSalidas-1">0.00</span>
              </div>
            </div>

            <!-- Cuadre -->
            <div class="cuadre-container">
              <h4>Cuadre Office</h4>
              <div class="cuadre-row">
                <label>Ventas:</label>
                <span id="ventas-1">0.00</span>
              </div>
              <div class="cuadre-row">
                <label>Salidas:</label>
                <span id="salidas-1">0.00</span>
              </div>
              <div class="cuadre-row">
                <label>Sub Total (Ventas - Salidas):</label>
                <span id="subTotal-1" class="total-subtotal">0.00</span>
              </div>
              <!-- Campos opcionales -->
              <div id="optionalFields-1">
                <!-- Ejemplo: Cash, Tickets, Sucursal, etc. Se agregan dinámicamente -->
              </div>
              <button
                class="btn btn-info"
                id="addOptionalFieldBtn-1"
              >
                Añadir Campo Opcional
              </button>
              <div class="cuadre-row mt-2">
                <label>Net Balance:</label>
                <span id="netBalance-1" class="net-balance cero">0.00</span>
              </div>
            </div>

            <!-- Botones Footer día -->
            <div class="mt-3 d-flex gap-3">
              <button
                class="btn btn-warning"
                id="resetDayBtn-1"
              >
                Reset Día
              </button>
              <button
                class="btn btn-primary"
                id="sendDayBtn-1"
              >
                Enviar a Sheets
              </button>
              <!-- Botón de Export PDF del día -->
              <button
                class="btn btn-success"
                id="exportPdfDayBtn-1"
              >
                Exportar PDF
              </button>
            </div>
          </div>
        </div>

        <!-- Repite exactamente igual para Martes, Miércoles, etc. Cambiando data-day-index -->
        <div
          class="tab-pane fade"
          id="pills-martes"
          role="tabpanel"
          aria-labelledby="pills-martes-tab"
        >
          <div class="day-tab" data-day-index="2">
            <div class="mb-3">
              <label>Nombre de la Tienda:</label>
              <input type="text" class="form-control" id="tienda-2" placeholder="Mi Tienda" />
            </div>
            <div class="mb-3 d-flex gap-3">
              <div>
                <label>Fecha (DD/MM/AAAA):</label>
                <input type="text" class="form-control" id="fecha-2" />
              </div>
              <div>
                <label>Día de la Semana:</label>
                <input
                  type="text"
                  class="form-control"
                  id="diaSemana-2"
                  value="Martes"
                  readonly
                />
              </div>
              <div class="d-flex align-items-end">
                <i
                  class="bi bi-unlock lock-icon unlocked"
                  id="lockDay-2"
                  data-day="2"
                  title="Bloquear/Desbloquear Día"
                ></i>
              </div>
            </div>
            <div class="table-responsive">
              <table class="table table-dark table-bordered pages-table" id="dayTable-2">
                <thead>
                  <tr>
                    <th># Página</th>
                    <th>Centenas</th>
                    <th>Pulitos</th>
                    <th class="text-center">Salidas</th>
                    <th>Total</th>
                    <th>Acción</th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
            <button class="btn btn-primary mb-3" id="addPageBtn-2">Añadir Página</button>
            <div class="row mb-3">
              <div class="col-md-3">
                <strong>Total Centenas:</strong>
                <span id="totalCentenas-2">0.00</span>
              </div>
              <div class="col-md-3">
                <strong>Total Pulitos:</strong>
                <span id="totalPulitos-2">0.00</span>
              </div>
              <div class="col-md-3">
                Overlook:
                <input
                  type="number"
                  id="overlook-2"
                  step="1"
                  placeholder="0"
                  class="form-control"
                  style="width:120px; display:inline-block;"
                />
              </div>
              <div class="col-md-3">
                <strong>Total Salidas:</strong>
                <span id="totalSalidas-2">0.00</span>
              </div>
            </div>
            <div class="cuadre-container">
              <h4>Cuadre Office</h4>
              <div class="cuadre-row">
                <label>Ventas:</label>
                <span id="ventas-2">0.00</span>
              </div>
              <div class="cuadre-row">
                <label>Salidas:</label>
                <span id="salidas-2">0.00</span>
              </div>
              <div class="cuadre-row">
                <label>Sub Total:</label>
                <span id="subTotal-2" class="total-subtotal">0.00</span>
              </div>
              <div id="optionalFields-2"></div>
              <button
                class="btn btn-info"
                id="addOptionalFieldBtn-2"
              >
                Añadir Campo Opcional
              </button>
              <div class="cuadre-row mt-2">
                <label>Net Balance:</label>
                <span id="netBalance-2" class="net-balance cero">0.00</span>
              </div>
            </div>
            <div class="mt-3 d-flex gap-3">
              <button class="btn btn-warning" id="resetDayBtn-2">Reset Día</button>
              <button class="btn btn-primary" id="sendDayBtn-2">Enviar a Sheets</button>
              <button class="btn btn-success" id="exportPdfDayBtn-2">Exportar PDF</button>
            </div>
          </div>
        </div>

        <!-- Pestaña Miércoles (data-day-index="3"), etc... -->
        <div
          class="tab-pane fade"
          id="pills-miercoles"
          role="tabpanel"
          aria-labelledby="pills-miercoles-tab"
        >
          <div class="day-tab" data-day-index="3">
            <!-- Repetir la misma estructura de arriba con IDs 3 -->
            <!-- ... -->
            <h4 class="text-center">Ejemplo, completa igual que Lunes</h4>
          </div>
        </div>

        <div
          class="tab-pane fade"
          id="pills-jueves"
          role="tabpanel"
          aria-labelledby="pills-jueves-tab"
        >
          <div class="day-tab" data-day-index="4">
            <h4 class="text-center">Jueves</h4>
            <!-- Estructura análoga -->
          </div>
        </div>
        <div
          class="tab-pane fade"
          id="pills-viernes"
          role="tabpanel"
          aria-labelledby="pills-viernes-tab"
        >
          <div class="day-tab" data-day-index="5">
            <h4 class="text-center">Viernes</h4>
            <!-- Estructura análoga -->
          </div>
        </div>
        <div
          class="tab-pane fade"
          id="pills-sabado"
          role="tabpanel"
          aria-labelledby="pills-sabado-tab"
        >
          <div class="day-tab" data-day-index="6">
            <h4 class="text-center">Sábado</h4>
            <!-- Estructura análoga -->
          </div>
        </div>
        <div
          class="tab-pane fade"
          id="pills-domingo"
          role="tabpanel"
          aria-labelledby="pills-domingo-tab"
        >
          <div class="day-tab" data-day-index="7">
            <h4 class="text-center">Domingo</h4>
            <!-- Estructura análoga -->
          </div>
        </div>

        <!-- =========================================
             2) Pestaña RESUMEN SEMANAL (8va)
             ========================================= -->
        <div
          class="tab-pane fade"
          id="pills-semanal"
          role="tabpanel"
          aria-labelledby="pills-semanal-tab"
        >
          <div class="weekly-container">
            <h3>Resumen Semanal</h3>
            <div class="weekly-row">
              <label>Total Ventas:</label>
              <span id="totalVentasSemana">0.00</span>
            </div>
            <div class="weekly-row">
              <label>Centenas 25%:</label>
              <span id="comisionCentenas">0.00</span>
            </div>
            <div class="weekly-row">
              <label>Pulitos 10%:</label>
              <span id="comisionPulitos">0.00</span>
            </div>
            <div class="weekly-row">
              <label>Total Comisión:</label>
              <span id="totalComision">0.00</span>
            </div>
            <div class="weekly-row">
              <label>Adelanto Oficina:</label>
              <input
                type="number"
                id="adelantoOficina"
                step="1"
                placeholder="0"
              />
            </div>
            <div class="weekly-row">
              <label>Total Salidas (Suma 7 días):</label>
              <span id="totalSalidasSemana">0.00</span>
            </div>
            <div class="weekly-row">
              <label>Sub Total (Ventas - Salidas - Comisión):</label>
              <span id="subTotalSemana">0.00</span>
            </div>
            <div class="weekly-row">
              <label>Caídas (20% si SubTotal > 0):</label>
              <input
                type="number"
                id="caidasSemana"
                step="1"
                placeholder="0"
              />
            </div>
            <div class="weekly-row">
              <label>Balance Oficina:</label>
              <span id="balanceOficina" class="net-balance cero">0.00</span>
            </div>
            <!-- Botones -->
            <div class="mt-3 d-flex gap-3">
              <button class="btn btn-warning" id="resetSemanaBtn">Reset Semana</button>
              <button class="btn btn-primary" id="saveSemanaBtn">Guardar/Enviar</button>
              <button
                class="btn btn-success"
                id="lockSemanaBtn"
                data-locked="false"
              >
                <i class="bi bi-unlock"></i> Bloqueo Semana
              </button>
            </div>
          </div>
        </div>

        <!-- =========================================
             3) Pestaña Manual (9na)
             ========================================= -->
        <div
          class="tab-pane fade"
          id="pills-manual"
          role="tabpanel"
          aria-labelledby="pills-manual-tab"
        >
          <div class="manual-section">
            <h3>Manual de Uso</h3>
            <p>
              Bienvenido a la interfaz de reporte diario y semanal. Aquí puedes
              llevar el registro de Centenas, Pulitos y Salidas, con totales y
              un consolidado semanal.
            </p>
            <ol>
              <li>
                <strong>Pestañas Diarias:</strong> cada día tiene su tabla con
                Páginas. Registra Centenas, Pulitos, Salidas y verás los totales
                al pie. “Overlook” se suma a las salidas. 
              </li>
              <li>
                <strong>Salidas Pendientes/Pagadas:</strong> haz clic en el campo
                Salidas para ver un modal con hasta 10 premios. Puedes marcar un
                premio como pendiente (morado) o pagado (rojo).
              </li>
              <li>
                <strong>Cuadre Office:</strong> al final de cada día verás Ventas,
                Salidas, SubTotal, campos opcionales (Cash, Sucursal, etc.) y el
                Net Balance.
              </li>
              <li>
                <strong>Bloqueo:</strong> cada día tiene un candado para
                bloquear/desbloquear la edición. La pestaña “Resumen” tiene un
                candado global para bloquear toda la semana.
              </li>
              <li>
                <strong>Resumen Semanal:</strong> verás la suma de Ventas y
                Salidas, la comisión (25% de Centenas + 10% Pulitos), Subtotal,
                Caídas y Balance de Oficina.
              </li>
              <li>
                <strong>LocalStorage:</strong> toda la información se guarda
                automáticamente en tu navegador. Se borra al hacer “Reset Día” o
                “Reset Semana”.
              </li>
              <li>
                <strong>Exportar a PDF:</strong> en cada día tienes un botón que
                hace captura de pantalla (html2canvas) para imprimir o guardar
                como imagen/PDF.
              </li>
              <li>
                <strong>PIN de Acceso:</strong> Se requiere 8325 para ver este
                módulo. 
              </li>
            </ol>
            <p><em>¡Listo! Ajusta tu lógica de negocio según necesites.</em></p>
          </div>
        </div>

      </div>
    </div>
  </div>

  <!-- MODAL para Detalle de Salidas Pendientes/Pagadas -->
  <div
    class="modal fade"
    id="salidasModal"
    tabindex="-1"
    aria-labelledby="salidasModalLabel"
    aria-hidden="true"
  >
    <div class="modal-dialog modal-lg modal-dialog-scrollable">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="salidasModalLabel">Detalle de Salidas</h5>
          <button
            type="button"
            class="btn-close btn-close-white"
            data-bs-dismiss="modal"
            aria-label="Close"
          ></button>
        </div>
        <div class="modal-body">
          <!-- Sección PENDIENTES -->
          <h5 class="text-center" style="color: var(--color-neon-morado);">
            Pendientes
          </h5>
          <div id="pendientesContainer" class="mb-4">
            <!-- Hasta 10 líneas -->
          </div>
          <!-- Sección PAGADOS -->
          <h5 class="text-center" style="color: #ff0044;">
            Pagados
          </h5>
          <div id="pagadosContainer">
            <!-- Hasta 10 líneas -->
          </div>
        </div>
        <div class="modal-footer">
          <button
            type="button"
            class="btn btn-secondary"
            data-bs-dismiss="modal"
          >
            Cerrar
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS -->
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
    defer
  ></script>
  
  <!-- 
    ================================
    SCRIPTS PRINCIPALES
    ================================
  -->
  <script>
    /*************************************************************
     * 1) LÓGICA DEL PIN OVERLAY
     *************************************************************/
    const pinOverlay = document.getElementById('pinOverlay');
    const pinInput = document.getElementById('pinInput');
    const pinSubmit = document.getElementById('pinSubmit');
    const pinCancel = document.getElementById('pinCancel');
    const accessReportBtn = document.getElementById('accessReportBtn');
    const mainReportContainer = document.getElementById('mainReportContainer');

    // Pin = 8325
    const CORRECT_PIN = '8325';

    accessReportBtn.addEventListener('click', () => {
      pinOverlay.style.display = 'flex';
      pinInput.value = '';
      pinInput.focus();
    });
    pinSubmit.addEventListener('click', () => {
      if (pinInput.value === CORRECT_PIN) {
        // Mostrar la interfaz
        pinOverlay.style.display = 'none';
        mainReportContainer.classList.remove('d-none');
      } else {
        alert('PIN incorrecto');
      }
    });
    pinCancel.addEventListener('click', () => {
      pinOverlay.style.display = 'none';
    });


    /*************************************************************
     * 2) TOGGLE DARK/LIGHT MODE
     *************************************************************/
    const toggleModeBtn = document.getElementById('toggleModeBtn');
    toggleModeBtn.addEventListener('click', () => {
      document.body.classList.toggle('light-mode');
      if (document.body.classList.contains('light-mode')) {
        toggleModeBtn.textContent = 'Modo Dark';
      } else {
        toggleModeBtn.textContent = 'Modo Light';
      }
    });


    /*************************************************************
     * 3) ESTRUCTURA DE DATOS Y LOCALSTORAGE
     *************************************************************/
    // Estructura en localStorage: 
    // { 
    //   days: {
    //     1: { tienda: "", fecha: "", ... , pages: [...], optionalFields: [...] },
    //     2: {...},
    //     ...
    //     7: {...}
    //   },
    //   weekly: {
    //     adelantoOficina, caidasSemana, ...
    //   }
    // }

    let dataStore = JSON.parse(localStorage.getItem('dailyReportData')) || {
      days: {},
      weekly: {}
    };

    // Inicializar 7 días si no existen
    for (let d = 1; d <= 7; d++) {
      if (!dataStore.days[d]) {
        dataStore.days[d] = {
          locked: false,
          tienda: '',
          fecha: '',
          diaSemana: '',
          pages: [],
          overlook: 0,
          optionalFields: []
        };
      }
      // Generar 20 filas por defecto si no hay pages
      if (dataStore.days[d].pages.length === 0) {
        for (let i = 1; i <= 20; i++) {
          dataStore.days[d].pages.push({
            pageIndex: i,
            centenas: '',
            pulitos: '',
            salidasTotal: '',
            salidasDetail: {
              pendientes: [],
              pagados: []
            }
          });
        }
      }
    }
    // Inicializar weekly
    if (!dataStore.weekly) {
      dataStore.weekly = {
        adelantoOficina: 0,
        caidasSemana: 0
      };
    }

    // Función para guardar en localStorage
    function saveData() {
      localStorage.setItem('dailyReportData', JSON.stringify(dataStore));
    }

    /*************************************************************
     * 4) RENDERIZAR DIA (TABLA DE PAGINAS)
     *************************************************************/
    function renderDay(dayIndex) {
      const dayData = dataStore.days[dayIndex];
      const tableBody = document.querySelector('#dayTable-' + dayIndex + ' tbody');
      if (!tableBody) return; // puede no existir en tabs no definidos

      // Limpia
      tableBody.innerHTML = '';
      // Inputs tienda, fecha, etc.
      const tiendaInput = document.getElementById('tienda-' + dayIndex);
      const fechaInput = document.getElementById('fecha-' + dayIndex);
      const diaSemanaInput = document.getElementById('diaSemana-' + dayIndex);
      const overlookInput = document.getElementById('overlook-' + dayIndex);

      if (tiendaInput) tiendaInput.value = dayData.tienda || '';
      if (fechaInput) fechaInput.value = dayData.fecha || '';
      if (diaSemanaInput && dayData.diaSemana) {
        diaSemanaInput.value = dayData.diaSemana;
      }
      if (overlookInput) overlookInput.value = dayData.overlook || 0;

      // Candado
      const lockIcon = document.getElementById('lockDay-' + dayIndex);
      if (lockIcon) {
        if (dayData.locked) {
          lockIcon.classList.remove('unlocked');
          lockIcon.classList.add('locked');
          lockIcon.classList.remove('bi-unlock');
          lockIcon.classList.add('bi-lock-fill');
        } else {
          lockIcon.classList.add('unlocked');
          lockIcon.classList.remove('locked');
          lockIcon.classList.add('bi-unlock');
          lockIcon.classList.remove('bi-lock-fill');
        }
      }

      // Render pages
      dayData.pages.forEach((page) => {
        const tr = document.createElement('tr');

        // # Página
        const tdPageIndex = document.createElement('td');
        tdPageIndex.textContent = '#' + page.pageIndex;
        tr.appendChild(tdPageIndex);

        // Centenas
        const tdCentenas = document.createElement('td');
        const inputCentenas = document.createElement('input');
        inputCentenas.type = 'number';
        inputCentenas.step = '1';
        inputCentenas.placeholder = '';
        inputCentenas.value = page.centenas;
        inputCentenas.disabled = dayData.locked;
        inputCentenas.addEventListener('input', () => {
          page.centenas = inputCentenas.value;
          saveAndRecalc(dayIndex);
        });
        tdCentenas.appendChild(inputCentenas);
        tr.appendChild(tdCentenas);

        // Pulitos
        const tdPulitos = document.createElement('td');
        const inputPulitos = document.createElement('input');
        inputPulitos.type = 'number';
        inputPulitos.step = '1';
        inputPulitos.placeholder = '';
        inputPulitos.value = page.pulitos;
        inputPulitos.disabled = dayData.locked;
        inputPulitos.addEventListener('input', () => {
          page.pulitos = inputPulitos.value;
          saveAndRecalc(dayIndex);
        });
        tdPulitos.appendChild(inputPulitos);
        tr.appendChild(tdPulitos);

        // Salidas (click -> modal)
        const tdSalidas = document.createElement('td');
        tdSalidas.classList.add('salidas-cell');
        tdSalidas.style.cursor = 'pointer';
        tdSalidas.textContent = page.salidasTotal || '';
        tdSalidas.disabled = dayData.locked;
        function updateSalidasCellColor() {
          const hasPendiente = (page.salidasDetail.pendientes.length > 0);
          const hasPagados = (page.salidasDetail.pagados.length > 0);
          if (hasPendiente) {
            // morado
            tdSalidas.classList.add('pendiente');
            tdSalidas.classList.remove('pagado');
          } else if (hasPagados) {
            // rojo
            tdSalidas.classList.add('pagado');
            tdSalidas.classList.remove('pendiente');
          } else {
            // sin color
            tdSalidas.classList.remove('pendiente', 'pagado');
          }
        }
        updateSalidasCellColor();
        tdSalidas.addEventListener('click', () => {
          // abrir modal con el detalle
          openSalidasModal(dayIndex, page.pageIndex);
        });
        tr.appendChild(tdSalidas);

        // Total
        const tdTotal = document.createElement('td');
        tdTotal.textContent = calcRowTotal(page);
        tr.appendChild(tdTotal);

        // Acción (eliminar fila)
        const tdAccion = document.createElement('td');
        const delBtn = document.createElement('button');
        delBtn.textContent = 'Borrar';
        delBtn.classList.add('table-row-btn');
        delBtn.disabled = dayData.locked;
        delBtn.addEventListener('click', () => {
          // Eliminar del array
          const idx = dayData.pages.indexOf(page);
          if (idx >= 0) {
            dayData.pages.splice(idx, 1);
            saveAndRecalc(dayIndex);
          }
        });
        tdAccion.appendChild(delBtn);
        tr.appendChild(tdAccion);

        tableBody.appendChild(tr);
      });

      // Render optional fields
      renderOptionalFields(dayIndex);

      // Recalcular totales
      recalcDay(dayIndex);
    }

    function calcRowTotal(page) {
      const c = parseFloat(page.centenas) || 0;
      const p = parseFloat(page.pulitos) || 0;
      return (c + p).toFixed(2);
    }

    function saveAndRecalc(dayIndex) {
      saveData();
      recalcDay(dayIndex);
      renderDay(dayIndex);
    }

    /*************************************************************
     * 5) RECALCULAR TOTALES DÍA
     *************************************************************/
    function recalcDay(dayIndex) {
      const dayData = dataStore.days[dayIndex];
      let sumCentenas = 0;
      let sumPulitos = 0;
      let sumSalidas = 0;

      dayData.pages.forEach((p) => {
        sumCentenas += parseFloat(p.centenas) || 0;
        sumPulitos += parseFloat(p.pulitos) || 0;
        sumSalidas += parseFloat(p.salidasTotal) || 0;
      });
      // Overlook
      const overlookVal = parseFloat(dayData.overlook) || 0;
      sumSalidas += overlookVal;

      // Asignar a HTML
      const totalCentenasSpan = document.getElementById('totalCentenas-' + dayIndex);
      const totalPulitosSpan = document.getElementById('totalPulitos-' + dayIndex);
      const totalSalidasSpan = document.getElementById('totalSalidas-' + dayIndex);
      const ventasSpan = document.getElementById('ventas-' + dayIndex);
      const salidasSpan = document.getElementById('salidas-' + dayIndex);
      const subTotalSpan = document.getElementById('subTotal-' + dayIndex);
      const netBalanceSpan = document.getElementById('netBalance-' + dayIndex);

      if (totalCentenasSpan) totalCentenasSpan.textContent = sumCentenas.toFixed(2);
      if (totalPulitosSpan) totalPulitosSpan.textContent = sumPulitos.toFixed(2);
      if (totalSalidasSpan) totalSalidasSpan.textContent = sumSalidas.toFixed(2);

      const ventas = sumCentenas + sumPulitos;
      if (ventasSpan) ventasSpan.textContent = ventas.toFixed(2);

      if (salidasSpan) salidasSpan.textContent = sumSalidas.toFixed(2);

      const subTotal = ventas - sumSalidas;
      if (subTotalSpan) subTotalSpan.textContent = subTotal.toFixed(2);

      // Sumar optionalFields
      let sumOptional = 0;
      dayData.optionalFields.forEach((opt) => {
        sumOptional += parseFloat(opt.value) || 0;
      });

      const netBalance = subTotal - sumOptional;
      if (netBalanceSpan) {
        netBalanceSpan.textContent = netBalance.toFixed(2);
        if (netBalance > 0) {
          netBalanceSpan.classList.add('positivo');
          netBalanceSpan.classList.remove('negativo', 'cero');
        } else if (netBalance < 0) {
          netBalanceSpan.classList.add('negativo');
          netBalanceSpan.classList.remove('positivo', 'cero');
        } else {
          netBalanceSpan.classList.add('cero');
          netBalanceSpan.classList.remove('positivo', 'negativo');
        }
      }
    }

    /*************************************************************
     * 6) MODAL SALIDAS (PENDIENTES/PAGADOS)
     *************************************************************/
    const salidasModal = new bootstrap.Modal(document.getElementById('salidasModal'));
    let currentModalDay = null;
    let currentModalPageIndex = null;
    const pendientesContainer = document.getElementById('pendientesContainer');
    const pagadosContainer = document.getElementById('pagadosContainer');

    function openSalidasModal(dayIndex, pageIndex) {
      currentModalDay = dayIndex;
      currentModalPageIndex = pageIndex;
      // Cargar data
      const page = dataStore.days[dayIndex].pages.find(p => p.pageIndex === pageIndex);
      if (!page) return;

      // Render pendientes
      pendientesContainer.innerHTML = '';
      page.salidasDetail.pendientes.forEach((monto, i) => {
        const div = document.createElement('div');
        div.classList.add('mb-2', 'salida-pendiente');
        div.textContent = monto;
        // Al hacer clic => pasar a pagado
        div.style.cursor = 'pointer';
        div.addEventListener('click', () => {
          // Mover a pagados
          page.salidasDetail.pendientes.splice(i, 1);
          page.salidasDetail.pagados.push(monto);
          calcSalidasTotal(page);
          saveData();
          openSalidasModal(dayIndex, pageIndex); // re-render
        });
        pendientesContainer.appendChild(div);
      });
      // Render pagados
      pagadosContainer.innerHTML = '';
      page.salidasDetail.pagados.forEach((monto, i) => {
        const div = document.createElement('div');
        div.classList.add('mb-2', 'salida-pagada');
        div.textContent = monto;
        div.style.cursor = 'pointer';
        div.addEventListener('click', () => {
          // pasar a pendiente
          page.salidasDetail.pagados.splice(i, 1);
          page.salidasDetail.pendientes.push(monto);
          calcSalidasTotal(page);
          saveData();
          openSalidasModal(dayIndex, pageIndex); // re-render
        });
        pagadosContainer.appendChild(div);
      });

      // Agregar opción para añadir +1 pendiente
      const addPendBtn = document.createElement('button');
      addPendBtn.classList.add('btn', 'btn-primary', 'mt-2');
      addPendBtn.textContent = 'Añadir Premio Pendiente';
      addPendBtn.addEventListener('click', () => {
        const val = prompt('Monto del premio pendiente:', '0');
        if (val) {
          const numVal = parseFloat(val) || 0;
          page.salidasDetail.pendientes.push(numVal);
          calcSalidasTotal(page);
          saveData();
          openSalidasModal(dayIndex, pageIndex);
        }
      });
      pendientesContainer.appendChild(addPendBtn);

      // Agregar opción para añadir +1 pagado
      const addPagBtn = document.createElement('button');
      addPagBtn.classList.add('btn', 'btn-danger', 'mt-2', 'ms-2');
      addPagBtn.textContent = 'Añadir Premio Pagado';
      addPagBtn.addEventListener('click', () => {
        const val = prompt('Monto del premio pagado:', '0');
        if (val) {
          const numVal = parseFloat(val) || 0;
          page.salidasDetail.pagados.push(numVal);
          calcSalidasTotal(page);
          saveData();
          openSalidasModal(dayIndex, pageIndex);
        }
      });
      pagadosContainer.appendChild(addPagBtn);

      calcSalidasTotal(page);

      salidasModal.show();
    }

    function calcSalidasTotal(page) {
      const pendSum = page.salidasDetail.pendientes.reduce((acc, val) => acc + parseFloat(val||0), 0);
      const pagSum = page.salidasDetail.pagados.reduce((acc, val) => acc + parseFloat(val||0), 0);
      page.salidasTotal = (pendSum + pagSum).toFixed(2);
    }

    /*************************************************************
     * 7) AÑADIR PÁGINAS
     *************************************************************/
    for (let d = 1; d <= 7; d++) {
      const addPageBtn = document.getElementById('addPageBtn-' + d);
      if (addPageBtn) {
        addPageBtn.addEventListener('click', () => {
          const dayData = dataStore.days[d];
          const nextIndex = dayData.pages.length + 1;
          dayData.pages.push({
            pageIndex: nextIndex,
            centenas: '',
            pulitos: '',
            salidasTotal: '',
            salidasDetail: {
              pendientes: [],
              pagados: []
            }
          });
          saveAndRecalc(d);
        });
      }
    }

    /*************************************************************
     * 8) OPTIONAL FIELDS (Cash, Sucursal, etc.)
     *************************************************************/
    function renderOptionalFields(dayIndex) {
      const container = document.getElementById('optionalFields-' + dayIndex);
      if (!container) return;
      container.innerHTML = '';
      const dayData = dataStore.days[dayIndex];

      dayData.optionalFields.forEach((field, i) => {
        const div = document.createElement('div');
        div.classList.add('optional-field');
        const input = document.createElement('input');
        input.type = 'number';
        input.value = field.value;
        input.placeholder = '0.00';
        input.step = '1';
        input.disabled = dayData.locked;
        input.addEventListener('input', () => {
          field.value = input.value;
          saveAndRecalc(dayIndex);
        });
        div.appendChild(input);

        const label = document.createElement('span');
        label.textContent = field.name;
        label.style.marginRight = '10px';
        label.style.marginLeft = '8px';
        div.appendChild(label);

        const delBtn = document.createElement('button');
        delBtn.textContent = 'X';
        delBtn.classList.add('delete-optional-btn');
        delBtn.disabled = dayData.locked;
        delBtn.addEventListener('click', () => {
          dayData.optionalFields.splice(i, 1);
          saveAndRecalc(dayIndex);
        });
        div.appendChild(delBtn);

        container.appendChild(div);
      });
    }

    for (let d = 1; d <= 7; d++) {
      const addOptBtn = document.getElementById('addOptionalFieldBtn-' + d);
      if (addOptBtn) {
        addOptBtn.addEventListener('click', () => {
          const dayData = dataStore.days[d];
          const name = prompt('Nombre del campo (ej. "Cash", "Sucursal", etc.)', 'Cash');
          if (name) {
            dayData.optionalFields.push({ name, value: '' });
            saveAndRecalc(d);
          }
        });
      }
    }

    /*************************************************************
     * 9) RESET DÍA
     *************************************************************/
    for (let d = 1; d <= 7; d++) {
      const resetBtn = document.getElementById('resetDayBtn-' + d);
      if (resetBtn) {
        resetBtn.addEventListener('click', () => {
          if (!confirm('¿Seguro que deseas resetear el día ' + d + '?')) return;
          dataStore.days[d] = {
            locked: false,
            tienda: '',
            fecha: '',
            diaSemana: dataStore.days[d].diaSemana || '',
            overlook: 0,
            pages: [],
            optionalFields: []
          };
          // 20 filas default
          for (let i = 1; i <= 20; i++) {
            dataStore.days[d].pages.push({
              pageIndex: i,
              centenas: '',
              pulitos: '',
              salidasTotal: '',
              salidasDetail: {
                pendientes: [],
                pagados: []
              }
            });
          }
          saveData();
          renderDay(d);
        });
      }
    }

    /*************************************************************
     * 10) BOTÓN ENVIAR A SHEETS
     *************************************************************/
    for (let d = 1; d <= 7; d++) {
      const sendBtn = document.getElementById('sendDayBtn-' + d);
      if (sendBtn) {
        sendBtn.addEventListener('click', () => {
          alert('Aquí iría la lógica para Enviar a Google Sheets o AppSheet. Día ' + d);
        });
      }
    }

    /*************************************************************
     * 11) EXPORTAR A PDF (html2canvas)
     *************************************************************/
    for (let d = 1; d <= 7; d++) {
      const exportBtn = document.getElementById('exportPdfDayBtn-' + d);
      if (exportBtn) {
        exportBtn.addEventListener('click', async () => {
          const dayContainer = document.querySelector('#pills-'+ getDayName(d).toLowerCase());
          if (!dayContainer) return;
          // Generar screenshot
          const canvas = await html2canvas(dayContainer);
          const link = document.createElement('a');
          link.download = 'Day'+d+'.png';
          link.href = canvas.toDataURL();
          link.click();
        });
      }
    }

    function getDayName(d) {
      // 1->lunes, 2->martes, ...
      const names = [
        'Lunes','Martes','Miercoles','Jueves','Viernes','Sabado','Domingo'
      ];
      return names[d-1] || 'Dia';
    }

    /*************************************************************
     * 12) BLOQUEAR/DESBLOQUEAR DÍA
     *************************************************************/
    for (let d = 1; d <= 7; d++) {
      const lockIcon = document.getElementById('lockDay-' + d);
      if (lockIcon) {
        lockIcon.addEventListener('click', () => {
          dataStore.days[d].locked = !dataStore.days[d].locked;
          saveData();
          renderDay(d);
        });
      }
    }

    /*************************************************************
     * 13) RENDERIZAR SEMANAL
     *************************************************************/
    const adelantoOficinaInput = document.getElementById('adelantoOficina');
    const caidasSemanaInput = document.getElementById('caidasSemana');
    const totalVentasSemanaSpan = document.getElementById('totalVentasSemana');
    const totalSalidasSemanaSpan = document.getElementById('totalSalidasSemana');
    const comisionCentenasSpan = document.getElementById('comisionCentenas');
    const comisionPulitosSpan = document.getElementById('comisionPulitos');
    const totalComisionSpan = document.getElementById('totalComision');
    const subTotalSemanaSpan = document.getElementById('subTotalSemana');
    const balanceOficinaSpan = document.getElementById('balanceOficina');

    function recalcSemana() {
      // Sumar totales de 7 días
      let sumCentenasAll = 0;
      let sumPulitosAll = 0;
      let sumSalidasAll = 0;

      for (let d = 1; d <= 7; d++) {
        const dayData = dataStore.days[d];
        let dayCentenas = 0, dayPulitos = 0, daySalidas = 0;
        dayData.pages.forEach(p => {
          dayCentenas += parseFloat(p.centenas) || 0;
          dayPulitos += parseFloat(p.pulitos) || 0;
          daySalidas += parseFloat(p.salidasTotal) || 0;
        });
        daySalidas += parseFloat(dayData.overlook) || 0;

        sumCentenasAll += dayCentenas;
        sumPulitosAll += dayPulitos;
        sumSalidasAll += daySalidas;
      }

      const totalVentas = sumCentenasAll + sumPulitosAll;
      const comiCent = sumCentenasAll * 0.25;
      const comiPul = sumPulitosAll * 0.1;
      const totalCom = comiCent + comiPul;
      const adelanto = parseFloat(dataStore.weekly.adelantoOficina) || 0;
      let subTotal = totalVentas - sumSalidasAll - totalCom - adelanto;
      if (subTotal < 0) {
        // Queda en negativo
      }

      // Caidas
      let caidas = parseFloat(dataStore.weekly.caidasSemana) || 0;
      // si subTotal > 0, se le puede calcular 20% auto
      // Pero el usuario es libre de ajustarlo...
      const balance = subTotal - caidas;

      if (totalVentasSemanaSpan) totalVentasSemanaSpan.textContent = totalVentas.toFixed(2);
      if (totalSalidasSemanaSpan) totalSalidasSemanaSpan.textContent = sumSalidasAll.toFixed(2);
      if (comisionCentenasSpan) comisionCentenasSpan.textContent = comiCent.toFixed(2);
      if (comisionPulitosSpan) comisionPulitosSpan.textContent = comiPul.toFixed(2);
      if (totalComisionSpan) totalComisionSpan.textContent = totalCom.toFixed(2);
      if (subTotalSemanaSpan) subTotalSemanaSpan.textContent = subTotal.toFixed(2);

      if (balanceOficinaSpan) {
        balanceOficinaSpan.textContent = balance.toFixed(2);
        if (balance > 0) {
          balanceOficinaSpan.classList.add('positivo');
          balanceOficinaSpan.classList.remove('negativo','cero');
        } else if (balance < 0) {
          balanceOficinaSpan.classList.add('negativo');
          balanceOficinaSpan.classList.remove('positivo','cero');
        } else {
          balanceOficinaSpan.classList.add('cero');
          balanceOficinaSpan.classList.remove('positivo','negativo');
        }
      }
    }
    if (adelantoOficinaInput) {
      adelantoOficinaInput.addEventListener('input', () => {
        dataStore.weekly.adelantoOficina = adelantoOficinaInput.value;
        saveData();
        recalcSemana();
      });
    }
    if (caidasSemanaInput) {
      caidasSemanaInput.addEventListener('input', () => {
        dataStore.weekly.caidasSemana = caidasSemanaInput.value;
        saveData();
        recalcSemana();
      });
    }

    /*************************************************************
     * 14) RESET SEMANA
     *************************************************************/
    const resetSemanaBtn = document.getElementById('resetSemanaBtn');
    if (resetSemanaBtn) {
      resetSemanaBtn.addEventListener('click', () => {
        if (!confirm('¿Seguro que deseas resetear toda la semana?')) return;
        // Resetea days
        for (let d = 1; d <= 7; d++) {
          dataStore.days[d] = {
            locked: false,
            tienda: '',
            fecha: '',
            diaSemana: dataStore.days[d].diaSemana || '',
            overlook: 0,
            pages: [],
            optionalFields: []
          };
          for (let i = 1; i <= 20; i++) {
            dataStore.days[d].pages.push({
              pageIndex: i,
              centenas: '',
              pulitos: '',
              salidasTotal: '',
              salidasDetail: {
                pendientes: [],
                pagados: []
              }
            });
          }
        }
        // Resetea weekly
        dataStore.weekly = {
          adelantoOficina: 0,
          caidasSemana: 0
        };
        saveData();
        // Rerender
        for (let d = 1; d <= 7; d++) {
          renderDay(d);
        }
        recalcSemana();
        alert('Semana reseteada.');
      });
    }

    /*************************************************************
     * 15) GUARDAR/ENVIAR SEMANA
     *************************************************************/
    const saveSemanaBtn = document.getElementById('saveSemanaBtn');
    if (saveSemanaBtn) {
      saveSemanaBtn.addEventListener('click', () => {
        // Lógica de guardado (puede mandar a Sheets la dataStore.weekly)
        alert('Semana guardada / enviada (placeholder).');
      });
    }

    /*************************************************************
     * 16) BLOQUEO GLOBAL SEMANA
     *************************************************************/
    const lockSemanaBtn = document.getElementById('lockSemanaBtn');
    if (lockSemanaBtn) {
      lockSemanaBtn.addEventListener('click', () => {
        const lockedNow = (lockSemanaBtn.getAttribute('data-locked') === 'true');
        const newVal = !lockedNow;
        lockSemanaBtn.setAttribute('data-locked', newVal);
        if (newVal) {
          lockSemanaBtn.innerHTML = '<i class="bi bi-lock-fill"></i> Desbloquear Semana';
          // Bloquear todos los días
          for (let d = 1; d <= 7; d++) {
            dataStore.days[d].locked = true;
          }
        } else {
          lockSemanaBtn.innerHTML = '<i class="bi bi-unlock"></i> Bloqueo Semana';
          // Desbloquear
          for (let d = 1; d <= 7; d++) {
            dataStore.days[d].locked = false;
          }
        }
        saveData();
        // Rerender
        for (let d = 1; d <= 7; d++) {
          renderDay(d);
        }
      });
    }

    /*************************************************************
     * 17) ARRANQUE INICIAL
     *************************************************************/
    // Llenar cada día
    for (let d = 1; d <= 7; d++) {
      renderDay(d);
    }
    recalcSemana();

    // Observa que en tu proyecto real, también podrías setear la 
    // fecha base para Lunes, Martes, etc., de forma automática 
    // usando JavaScript (sumar días a la fecha base).
  </script>
</body>
</html>
